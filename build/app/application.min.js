"use strict";angular.module("com.att.controllers.config",[]).constant("config",{audioPath:"media/audio/",dataPath:"rest/api/data/"});var videoData,svmodule=angular.module("smartvideo",["ngRoute","ngSanitize","com.att.controllers.config"]);svmodule.controller("SVMainController",["$rootScope","$scope","$http","$q","config",function(a,b,c,d,e){function f(a){a=a.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var b=new RegExp("[\\?&]"+a+"=([^&#]*)"),c=b.exec(location.search);return null===c?"":decodeURIComponent(c[1].replace(/\+/g," "))}function g(a,b){var c=document.getElementsByTagName("link").item(b),d=document.createElement("link");d.setAttribute("rel","stylesheet"),d.setAttribute("type","text/css"),d.setAttribute("href",a),document.getElementsByTagName("head").item(0).replaceChild(d,c)}function h(){void 0!=a.videoData.relatedVideos&&a.videoData.relatedVideos.length>0&&(b.playlists=a.videoData.relatedVideos,a.showpl=!0)}function i(){$("#imgdiv1").show(),$("#videoViewport").hide(),$(".audioplayer").remove(),b.showPlaylists=!1,$("#showPlBtn a").removeClass("active"),$("#videodiv").prepend(' <audio id="ourvideo" controls  height="1px"><source id="audioSource" src=""></audio>')}a.showCC=!1,a.seekedTime="",a.datatype="",b.playlists=[],b.showPlaylists=!1,b.fullScreenMode=!1,b.showHeader=!0,b.videojs="",angular.element(document).ready(function(){function d(a,b){a.preventDefault();var c=$(b).attr("href"),d=$(b).attr("target");j.push(["_trackPageview",c]),setTimeout(function(){console.log("Event recorded"),window.open(c,d?d:"_self")},300)}var h=f("type");""==h&&(h="orderstatus"),b.videoType=h;var i=f("id");b.videoId=i;var j=j||[];j.push(["_setAccount","UA-52702404-1"]),j.push(["_trackPageview"]),j.push(["_trackPageview","videoID="+i]),$("a").each(function(){$(this).click(function(a){d(a,$(this))})}),"ecare"!=h?c.get(e.dataPath+i+"/script.json").success(function(b){a.videoData=b,videoData=b,videoData.media=e.audioPath+i+"/"+videoData.media,"adobeanimate"==h?(g("../svp/lib/videojs/global.css",0),$("#canvas").show(),$(".video-js-responsive-container").prepend(' <audio id="canvasvideo" class="video-js vjs-default-skin"  controls preload="auto" height="100%" width="100%" > <source id="CanvasaudioSource" src="" type="" /><track id="cc" kind="captions" src="" srclang="en" label="Caption" default><track id="subtit" kind="subtitles" src="" srclang="en" label="English" default><track id="chptr" kind="chapters" src="" srclang="en"></audio>'),$("#CanvasaudioSource").attr("src","app/template/adobeanimate/sounds/audio.mp3"),void 0!=videoData.media?-1==videoData.media.indexOf(".m4a")?$("#CanvasaudioSource").attr("type","audio/mp3"):$("#CanvasaudioSource").attr("type","audio/mp4"):$("#CanvasaudioSource").attr("type","audio/mp3"),$("#cc").attr("src","assets/data/hs_caption.vtt"),$("#subtit").attr("src","assets/data/hs_subtitle.vtt"),$("#chptr").attr("src","assets/data/hs_chapter.vtt"),$("#videoViewport").append($("#canvasvideo")),videojs=videojs("canvasvideo",{controls:!0,autoplay:!0,preload:"auto",html5:{nativeTextTracks:!1}},function(){}),$("#canvas").insertBefore($(".vjs-tech")),videojs.on("play",function(){createjs.Ticker.paused=!1}),videojs.on("pause",function(){createjs.Ticker.paused=!0}),videojs.on("seeked",function(){seekedTime=this.currentTime()})):(a.datatype=void 0!=videoData.format?videoData.format:"html",void 0!=a.datatype&&("html"==a.datatype?($("#canvas").hide(),$(".video-js-responsive-container").prepend(' <audio id="ourvideo" class="video-js vjs-default-skin" style="display:none;" controls preload="auto" height="100%" width="100%" > <source id="audioSource" src="" type="" /><track id="cc" kind="captions" src="" srclang="en" label="Caption" default><track id="subtit" kind="subtitles" src="" srclang="en" label="English" default><track id="chptr" kind="chapters" src="" srclang="en"></audio>'),$("#audioSource").attr("src",videoData.media),void 0!=videoData.media?-1==videoData.media.indexOf(".m4a")?$("#audioSource").attr("type","audio/mp3"):$("#audioSource").attr("type","audio/mp4"):$("#audioSource").attr("type","audio/mp3"),$("#cc").attr("src","assets/data/os_caption.vtt"),$("#subtit").attr("src","assets/data/os_subtitle.vtt"),$("#chptr").attr("src","assets/data/os_chapter.vtt"),$("#videoViewport").insertBefore($(".vjs-tech"))):($("#canvas").hide(),$(".video-js-responsive-container").prepend(' <video id="newvideo" class="video-js vjs-default-skin"  controls preload="auto" width="100%" height="100%" > <source id="videoSource" src="" type=""><track id="cc" kind="captions" src="" srclang="en" label="Caption" default><track id="subtit" kind="subtitles" src="" srclang="en" label="English" default><track id="chptr" kind="chapters" src="" srclang="en"><button class="previous">Previous</button><button class="next">Next</button><div class="autoadvance-group"><h4>Auto-advance (in seconds)</h4><label><input type="radio" name="autoadvance" value="null" checked> No auto-advance</label><label><input type="radio" name="autoadvance" value="0"> 0</label><label><input type="radio" name="autoadvance" value="5"> 5</label><label><input type="radio" name="autoadvance" value="10"> 10</label><label><input type="radio" name="autoadvance" value="30"> 30</label></div></video>'),$("#videoSource").attr("src",videoData.media),void 0!=videoData.media?-1==videoData.media.indexOf(".m4a")?$("#videoSource").attr("type","video/mp4"):$("#videoSource").attr("type","audio/mp4"):$("#videoSource").attr("type","video/mp4"),$("#cc").attr("src","assets/data/os_caption.vtt"),$("#subtit").attr("src","assets/data/os_subtitle.vtt"),$("#chptr").attr("src","assets/data/os_chapter.vtt"),videojs("newvideo",{controls:!0,autoplay:!0,preload:"auto",fluid:!0,html5:{nativeTextTracks:!1}}))))}):(b.showHeader=!1,c.get(e.dataPath+i+"/script.json").success(function(b){a.videoData=b,videoData=b,videoData.audio=e.audioPath+i+"/output.wav"})),$("#closedCaptionBtn a").click(function(){$("#closedCaption").hasClass("shown")?($("#closedCaption").removeClass("shown"),$("#closedCaptionBtn a").removeClass("active")):($("#closedCaptionBtn a").addClass("active"),$("#closedCaption").addClass("shown"))})}),a.$on("customizeplayer",function(){}),b.$on("controllerLoaded",function(){b.templateUrl="app/template/"+b.videoType+"/template/animate.html"}),b.$watch("videoData",function(){if(a.showCC=!1,b.playlists=[],b.showPlaylists=!1,void 0!=a.videoData){var c=b.videoType;$('link[rel=stylesheet][href*="style.css"]').remove();var e=document.createElement("link");e.type="text/css",e.rel="stylesheet",e.href="app/template/"+c+"/css/style.css","adobeanimate"!=b.videoType&&document.getElementsByTagName("head")[0].appendChild(e);var f=d.defer(),g="app/template/"+c+"/js/animate.js";$script(g,function(){a.$apply(function(){f.resolve(),b.$broadcast("controllerLoaded")})}),b.imageUrl="app/template/"+c+"/images/headline.png",h()}}),b.showPlaylist=function(){b.showPlaylists?($("#showPlBtn a").removeClass("active"),b.showPlaylists=!1):(b.showPlaylists=!0,$("#showPlBtn a").addClass("active"))},b.playVideo=function(d,e){var f=d;void 0!=e&&(f=d+"_"+e),c.get("assets/data/"+f+".json").success(function(c){i(),b.videoType=d,"ecare"!=d?(ga("send","pageview"),a.videoData=c[0],videoData=c[0]):(a.videoData=c,videoData=c,a.$broadcast("videoChanged"))})},b.showFullScreen=function(){if($(window).width()>480)if(b.fullScreenMode){b.fullScreenMode=!1,$("#fullscreen a").removeClass("active"),$("#body").removeClass("fullScreen"),$("#container").removeClass("fullScreen"),$("#videoViewport").removeClass("fullScreen"),$("#videodiv").removeClass("fullScreen"),$("#videoViewport").removeAttr("style"),$("#videoViewport").show();var a=$("#videoViewport").height();$(".webpagedivseg").css("height",a-27+"px"),$(".header").show()}else{b.fullScreenMode=!0,$(".header").hide(),$("#fullscreen a").addClass("active"),$("#body").addClass("fullScreen"),$("#container").addClass("fullScreen"),$("#videoViewport").addClass("fullScreen"),$("#videodiv").addClass("fullScreen");var c=($(".header").height(),$(window).height());$("#videoViewport").css("height",c-30+"px"),$(".webpagedivseg").css("height",c-30+"px")}}}]),svmodule.config(["$routeProvider","$controllerProvider",function(a,b){svmodule.controllerProvider=b}]);